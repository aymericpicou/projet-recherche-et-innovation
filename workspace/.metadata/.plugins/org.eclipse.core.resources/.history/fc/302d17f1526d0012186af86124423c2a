package fr.tse.lt2c.satin;
import topic.TopicExtractor;
import topic.TopicModelingResult;


import java.io.File;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Collection;
import java.util.HashMap;
import java.util.Map;

import cc.mallet.examples.TopicModel;
import cc.mallet.examples.TrainCRF;
import cc.mallet.pipe.Pipe;
import cc.mallet.topics.LDA;
import cc.mallet.topics.SimpleLDA;
import cc.mallet.topics.tui.TopicTrainer;
import cc.mallet.topics.tui.Vectors2Topics;
import cc.mallet.types.InstanceList;
import cc.mallet.util.CommandOption;
import cc.mallet.util.Randoms;

public class TestLecture {

	/**
	 * @param args
	 */
	public static void main(String[] args) {
		Map<String, Collection<String>> twitterDataset = LectureDataset.lireJeuDonnees("twitter.obj");
		/*Map<String, Collection<String>> le premier string est surement le nom de l'utilisateur, le colection <string> 
		 * est surement l'ensemble de ses tweet*/
		Map<String, int[]> coords=new HashMap<>();/*le premier parametre est le nom des utilisateur, le second : la
		*liste des coordonnées de l'utilisateur en question*/
		String dataset="";
		int j=0;
		for (String user : twitterDataset.keySet()) {//on concatene tout les tweet dans une seule chaine de caractere
			if(j<1000){
			dataset+=twitterDataset.get(user);}
			j++;
		} 
		TopicExtractor ext = new TopicExtractor(dataset, 100, 20, 20, 4);//extraction des themes
		
		TopicModelingResult results = ext.modelingResult();//on analyse le document
		results.prepareInstancesResult();
		ArrayList<String[]> list = results.topicsList();
		System.out.println("voici les themes pour l'ensembe des tweet : \n");
		for (String[] l : list) {
			for (int i = 0; i < l.length; i++)
				System.out.print(l[i] + " ");
			System.out.println("\n");
		}	
		System.out.println("voici le détail sur les premiers tweet : \n");

		String tweets;
		for (String user : twitterDataset.keySet()) {
			int tab[];
			tab=new int[20];

			tweets=twitterDataset.get(user).toString();
			String word="";
			for(int i=0; i<tweets.length(); i++){
				if(tweets.charAt(i)!=' '){
					word+=tweets.charAt(i);
				}
				else{
				for (String[] l : list) {
					for (int k = 0; k < l.length; k++)
						if(l[k].equals(word)){System.out.println("le user " + user+ "a tweeté : " + word);
						}
				}
				word="";
				}
				
			}
		}
			
		}
		

}
	

